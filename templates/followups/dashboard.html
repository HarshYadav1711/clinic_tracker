{% extends "base.html" %}

{% block content %}
<h2>Dashboard</h2>

<p>
    Total: {{ total }} |
    Pending: {{ pending }} |
    Done: {{ done }}
</p>

<p>
    <a href="/create/">Create new follow-up</a>
</p>

<table border="1" cellpadding="5">
    <tr>
        <th>Patient</th>
        <th>Phone</th>
        <th>Due Date</th>
        <th>Status</th>
        <th>Language</th>
        <th>Public Link</th>
        <th>Actions</th>
    </tr>

    {% for f in followups %}
    <tr>
        <td>{{ f.patient_name }}</td>
        <td>{{ f.phone }}</td>
        <td>{{ f.due_date }}</td>
        <td>{{ f.status }}</td>
        <td>{{ f.language }}</td>
        <td>
            <a href="/p/{{ f.public_token }}/" target="_blank">
                Open
            </a>
        </td>
        <td>
            <a href="/{{ f.id }}/edit/">Edit</a>

            {% if f.status != "done" %}
            <form method="post" action="/{{ f.id }}/done/" style="display:inline;">
                {% csrf_token %}
                <button type="submit">Mark Done</button>
            </form>
            {% endif %}
        </td>
    </tr>
    {% empty %}
    <tr>
        <td colspan="7">No follow-ups found.</td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
